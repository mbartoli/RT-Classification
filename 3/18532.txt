An ambitious and moving but bleak film